# Sentinel Dashboard å‰ç«¯é¡µé¢è®¾è®¡

> ç‰ˆæœ¬ï¼š1.0
> æ›´æ–°æ—¥æœŸï¼š2025-12-05

---

## 1. é¡µé¢æ€»è§ˆ

åŸºäºæ—§ç‰ˆ Sentinel Dashboard åŠŸèƒ½ï¼Œå‰ç«¯éœ€è¦å®ç°ä»¥ä¸‹é¡µé¢ï¼š

| é¡µé¢     | è·¯å¾„                              | è¯´æ˜          | çŠ¶æ€          |
| -------- | --------------------------------- | ------------- | ------------- |
| ç™»å½•     | `/auth/sign-in`                   | ç”¨æˆ·ç™»å½•      | âœ… å®Œæˆ       |
| é¦–é¡µ     | `/dashboard`                      | åº”ç”¨åˆ—è¡¨æ€»è§ˆ  | âœ… åŸºç¡€å®Œæˆ   |
| ç°‡ç‚¹é“¾è·¯ | `/dashboard/apps/:app/identity`   | èµ„æºè°ƒç”¨é“¾è·¯  | âŒ å¾…å¼€å‘     |
| å®æ—¶ç›‘æ§ | `/dashboard/apps/:app/metric`     | å®æ—¶ QPS ç›‘æ§ | ğŸ”„ éœ€å®Œå–„å›¾è¡¨ |
| æµæ§è§„åˆ™ | `/dashboard/apps/:app/flow`       | æµæ§è§„åˆ™ CRUD | âœ… åŸºç¡€å®Œæˆ   |
| é™çº§è§„åˆ™ | `/dashboard/apps/:app/degrade`    | ç†”æ–­é™çº§è§„åˆ™  | âœ… åŸºç¡€å®Œæˆ   |
| çƒ­ç‚¹è§„åˆ™ | `/dashboard/apps/:app/param-flow` | çƒ­ç‚¹å‚æ•°è§„åˆ™  | âœ… åŸºç¡€å®Œæˆ   |
| ç³»ç»Ÿè§„åˆ™ | `/dashboard/apps/:app/system`     | ç³»ç»Ÿä¿æŠ¤è§„åˆ™  | ğŸ”„ ç¼ºå°‘ç¼–è¾‘   |
| æˆæƒè§„åˆ™ | `/dashboard/apps/:app/authority`  | é»‘ç™½åå•è§„åˆ™  | âœ… åŸºç¡€å®Œæˆ   |
| æœºå™¨åˆ—è¡¨ | `/dashboard/apps/:app/machines`   | æœºå™¨ç®¡ç†      | âœ… åŸºç¡€å®Œæˆ   |
| é›†ç¾¤æµæ§ | `/dashboard/apps/:app/cluster/*`  | é›†ç¾¤æµæ§é…ç½®  | ğŸ”„ éœ€å®Œå–„     |

---

## 2. ä¾§è¾¹æ å¯¼èˆªè®¾è®¡

### 2.1 å¯¼èˆªç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” [åº”ç”¨åæœç´¢]      [æœç´¢] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ  é¦–é¡µ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¼ {åº”ç”¨å}           (1/1)  â”‚  <- åº”ç”¨å + (å¥åº·æœºå™¨/æ€»æœºå™¨)
â”‚   â”œâ”€ ğŸ“Š å®æ—¶ç›‘æ§            â”‚
â”‚   â”œâ”€ ğŸ”— ç°‡ç‚¹é“¾è·¯            â”‚  <- æ–°å¢
â”‚   â”œâ”€ ğŸš¦ æµæ§è§„åˆ™            â”‚
â”‚   â”œâ”€ âš¡ ç†”æ–­è§„åˆ™            â”‚
â”‚   â”œâ”€ ğŸ”¥ çƒ­ç‚¹è§„åˆ™            â”‚
â”‚   â”œâ”€ ğŸ–¥ï¸ ç³»ç»Ÿè§„åˆ™            â”‚
â”‚   â”œâ”€ ğŸ” æˆæƒè§„åˆ™            â”‚
â”‚   â”œâ”€ ğŸ‘¥ é›†ç¾¤æµæ§            â”‚
â”‚   â””â”€ ğŸ’» æœºå™¨åˆ—è¡¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 å¯¼èˆªèœå•é…ç½®

```typescript
// åº”ç”¨çº§åˆ«èœå•ï¼ˆé€‰ä¸­åº”ç”¨åæ˜¾ç¤ºï¼‰
const appMenuItems = [
  { key: "metric", title: "å®æ—¶ç›‘æ§", icon: "chart-line", path: "/metric" },
  { key: "identity", title: "ç°‡ç‚¹é“¾è·¯", icon: "sitemap", path: "/identity" },
  { key: "flow", title: "æµæ§è§„åˆ™", icon: "funnel", path: "/flow" },
  { key: "degrade", title: "ç†”æ–­è§„åˆ™", icon: "shield-exclamation", path: "/degrade" },
  { key: "param-flow", title: "çƒ­ç‚¹è§„åˆ™", icon: "fire", path: "/param-flow" },
  { key: "system", title: "ç³»ç»Ÿè§„åˆ™", icon: "cog", path: "/system" },
  { key: "authority", title: "æˆæƒè§„åˆ™", icon: "key", path: "/authority" },
  { key: "cluster", title: "é›†ç¾¤æµæ§", icon: "users", path: "/cluster/server" },
  { key: "machines", title: "æœºå™¨åˆ—è¡¨", icon: "desktop", path: "/machines" },
];
```

---

## 3. é¡µé¢è¯¦ç»†è®¾è®¡

### 3.1 ç°‡ç‚¹é“¾è·¯é¡µé¢ï¼ˆæ ¸å¿ƒæ–°å¢é¡µé¢ï¼‰

**åŠŸèƒ½æè¿°**ï¼š
æ˜¾ç¤ºåº”ç”¨çš„æ‰€æœ‰èµ„æºè°ƒç”¨é“¾è·¯ï¼Œå±•ç¤ºå®æ—¶æ•°æ®ï¼Œæ”¯æŒå¿«é€Ÿæ·»åŠ è§„åˆ™ã€‚

**é¡µé¢å¸ƒå±€**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {åº”ç”¨å}                              [æ ‘çŠ¶è§†å›¾] [åˆ—è¡¨è§†å›¾] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç°‡ç‚¹é“¾è·¯                                                           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ æœºå™¨: [ä¸‹æ‹‰] â”‚  â”‚ å…³é”®å­—: [è¾“å…¥æ¡†] â”‚                 â”‚ [åˆ·æ–°]  â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èµ„æºå        â”‚ é€šè¿‡QPS â”‚ æ‹’ç»QPS â”‚ çº¿ç¨‹æ•° â”‚ å¹³å‡RT â”‚ åˆ†é’Ÿé€šè¿‡/æ‹’ç» â”‚ æ“ä½œ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¶ resource_1  â”‚   100   â”‚    5    â”‚   10   â”‚  32ms  â”‚   5000/200    â”‚ [+]  â”‚
â”‚   â””â”€ child_1  â”‚    50   â”‚    0    â”‚    5   â”‚  20ms  â”‚   2500/0      â”‚ [+]  â”‚
â”‚ resource_2    â”‚    80   â”‚    2    â”‚    8   â”‚  25ms  â”‚   4000/100    â”‚ [+]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…± 136 æ¡è®°å½•  æ¯é¡µ [16] æ¡                    Â« < 1 2 3 4 5 > Â»   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ“ä½œæŒ‰é’®å±•å¼€**ï¼š

```
[+æµæ§] [+ç†”æ–­] [+çƒ­ç‚¹] [+æˆæƒ]
```

**API**ï¼š

- `GET /resource/machineResource.json?ip=&port=&type=&searchKey=`

**ç»„ä»¶æ‹†åˆ†**ï¼š

```
pages/dashboard/identity/
â”œâ”€â”€ index.tsx              # é¡µé¢å…¥å£
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ResourceTable.tsx  # èµ„æºè¡¨æ ¼ï¼ˆæ”¯æŒæ ‘çŠ¶/åˆ—è¡¨ï¼‰
â”‚   â”œâ”€â”€ ResourceRow.tsx    # èµ„æºè¡Œï¼ˆå¯å±•å¼€å­èŠ‚ç‚¹ï¼‰
â”‚   â”œâ”€â”€ MachineSelector.tsx # æœºå™¨é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ ViewToggle.tsx     # è§†å›¾åˆ‡æ¢æŒ‰é’®
â”‚   â””â”€â”€ QuickRuleDialog.tsx # å¿«é€Ÿæ·»åŠ è§„åˆ™å¯¹è¯æ¡†
```

---

### 3.2 å®æ—¶ç›‘æ§é¡µé¢ï¼ˆéœ€å®Œå–„å›¾è¡¨ï¼‰

**å½“å‰çŠ¶æ€**ï¼šåªæœ‰è¡¨æ ¼å±•ç¤ºï¼Œç¼ºå°‘å›¾è¡¨

**ç›®æ ‡è®¾è®¡**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {åº”ç”¨å} - å®æ—¶ç›‘æ§                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚                     QPS è¶‹åŠ¿å›¾ (æŠ˜çº¿å›¾)                       â”‚   â”‚
â”‚ â”‚  â”â”â” é€šè¿‡QPS   â”â”â” æ‹’ç»QPS   â”â”â” å¼‚å¸¸QPS                     â”‚   â”‚
â”‚ â”‚      â†‘                                                       â”‚   â”‚
â”‚ â”‚  100 â”¤     â•­â”€â•®                                              â”‚   â”‚
â”‚ â”‚   80 â”¤   â•­â”€â•¯ â•°â”€â•®                                            â”‚   â”‚
â”‚ â”‚   60 â”¤ â•­â”€â•¯     â•°â”€â•®                                          â”‚   â”‚
â”‚ â”‚   40 â”¤â”€â•¯         â•°â”€â”€â”€â”€â”€                                     â”‚   â”‚
â”‚ â”‚    0 â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ—¶é—´          â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚ èµ„æºåˆ—è¡¨                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                                                â”‚ [åˆ·æ–°]  â”‚         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èµ„æºå        â”‚ é€šè¿‡QPS â”‚ æ‹’ç»QPS â”‚ çº¿ç¨‹æ•° â”‚ å¹³å‡RT â”‚               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼               â”‚
â”‚ resource_1    â”‚   100   â”‚    5    â”‚   10   â”‚  32ms  â”‚               â”‚
â”‚ resource_2    â”‚    80   â”‚    2    â”‚    8   â”‚  25ms  â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ç»„ä»¶æ‹†åˆ†**ï¼š

```
pages/dashboard/metric/
â”œâ”€â”€ index.tsx              # é¡µé¢å…¥å£
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ MetricChart.tsx    # QPS è¶‹åŠ¿å›¾
â”‚   â”œâ”€â”€ MetricTable.tsx    # èµ„æºæ•°æ®è¡¨æ ¼
â”‚   â””â”€â”€ TimeRangeSelector.tsx # æ—¶é—´èŒƒå›´é€‰æ‹©
```

---

### 3.3 è§„åˆ™åˆ—è¡¨é¡µé¢ï¼ˆé€šç”¨æ¨¡å¼ï¼‰

æ‰€æœ‰è§„åˆ™é¡µé¢å…±ç”¨ç±»ä¼¼å¸ƒå±€ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ {è§„åˆ™ç±»å‹}è§„åˆ™                                      [+ æ–°å¢è§„åˆ™]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åº”ç”¨: {åº”ç”¨å}                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚ â”‚ å…³é”®å­—: [æœç´¢æ¡†] â”‚                                               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ èµ„æºå â”‚ ... è§„åˆ™ç‰¹å®šå­—æ®µ ... â”‚ æ“ä½œ                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ xxx    â”‚ ...                  â”‚ [ç¼–è¾‘] [åˆ é™¤]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…± X æ¡è®°å½•  æ¯é¡µ [16] æ¡                         Â« < 1 2 3 > Â»    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é€šç”¨ç»„ä»¶**ï¼š

```
components/dashboard/rules/
â”œâ”€â”€ RuleListLayout.tsx     # è§„åˆ™åˆ—è¡¨é€šç”¨å¸ƒå±€
â”œâ”€â”€ RuleSearchBar.tsx      # æœç´¢æ 
â”œâ”€â”€ Pagination.tsx         # åˆ†é¡µç»„ä»¶
â”œâ”€â”€ ConfirmDeleteDialog.tsx # åˆ é™¤ç¡®è®¤æ¡†
â”‚
â”œâ”€â”€ FlowRuleForm.tsx       # æµæ§è§„åˆ™è¡¨å•
â”œâ”€â”€ DegradeRuleForm.tsx    # é™çº§è§„åˆ™è¡¨å•
â”œâ”€â”€ ParamFlowRuleForm.tsx  # çƒ­ç‚¹è§„åˆ™è¡¨å•
â”œâ”€â”€ SystemRuleForm.tsx     # ç³»ç»Ÿè§„åˆ™è¡¨å•
â””â”€â”€ AuthorityRuleForm.tsx  # æˆæƒè§„åˆ™è¡¨å•
```

---

### 3.4 è§„åˆ™å­—æ®µå¯¹ç…§è¡¨

#### æµæ§è§„åˆ™ (FlowRule)

| å­—æ®µ              | æ˜¾ç¤ºå   | ç±»å‹    | è¯´æ˜                          |
| ----------------- | -------- | ------- | ----------------------------- |
| resource          | èµ„æºå   | string  | è§„åˆ™ä½œç”¨çš„èµ„æº                |
| limitApp          | æ¥æºåº”ç”¨ | string  | æ¥æºé™åˆ¶ï¼Œdefault è¡¨ç¤ºä¸é™    |
| grade             | é˜ˆå€¼ç±»å‹ | 0/1     | 0:çº¿ç¨‹æ•°, 1:QPS               |
| count             | é˜ˆå€¼     | number  | é™æµé˜ˆå€¼                      |
| strategy          | æµæ§æ¨¡å¼ | 0/1/2   | 0:ç›´æ¥, 1:å…³è”, 2:é“¾è·¯        |
| refResource       | å…³è”èµ„æº | string  | å…³è”/é“¾è·¯æ¨¡å¼æ—¶çš„èµ„æº         |
| controlBehavior   | æµæ§æ•ˆæœ | 0/1/2   | 0:å¿«é€Ÿå¤±è´¥, 1:Warm Up, 2:æ’é˜Ÿ |
| warmUpPeriodSec   | é¢„çƒ­æ—¶é•¿ | number  | Warm Up é¢„çƒ­æ—¶é—´(ç§’)          |
| maxQueueingTimeMs | è¶…æ—¶æ—¶é—´ | number  | æ’é˜Ÿç­‰å¾…è¶…æ—¶(æ¯«ç§’)            |
| clusterMode       | é›†ç¾¤æ¨¡å¼ | boolean | æ˜¯å¦é›†ç¾¤é™æµ                  |

#### é™çº§è§„åˆ™ (DegradeRule)

| å­—æ®µ               | æ˜¾ç¤ºå     | ç±»å‹   | è¯´æ˜                               |
| ------------------ | ---------- | ------ | ---------------------------------- |
| resource           | èµ„æºå     | string | è§„åˆ™ä½œç”¨çš„èµ„æº                     |
| grade              | ç†”æ–­ç­–ç•¥   | 0/1/2  | 0:æ…¢è°ƒç”¨æ¯”ä¾‹, 1:å¼‚å¸¸æ¯”ä¾‹, 2:å¼‚å¸¸æ•° |
| count              | é˜ˆå€¼       | number | ç­–ç•¥å¯¹åº”çš„é˜ˆå€¼                     |
| timeWindow         | ç†”æ–­æ—¶é•¿   | number | ç†”æ–­æ¢å¤æ—¶é—´(ç§’)                   |
| minRequestAmount   | æœ€å°è¯·æ±‚æ•° | number | è§¦å‘ç†”æ–­çš„æœ€å°è¯·æ±‚æ•°               |
| statIntervalMs     | ç»Ÿè®¡æ—¶é•¿   | number | ç»Ÿè®¡çª—å£(æ¯«ç§’)                     |
| slowRatioThreshold | æ…¢è°ƒç”¨æ¯”ä¾‹ | number | æ…¢è°ƒç”¨æ¯”ä¾‹é˜ˆå€¼                     |

#### çƒ­ç‚¹è§„åˆ™ (ParamFlowRule)

| å­—æ®µ              | æ˜¾ç¤ºå   | ç±»å‹    | è¯´æ˜             |
| ----------------- | -------- | ------- | ---------------- |
| resource          | èµ„æºå   | string  | è§„åˆ™ä½œç”¨çš„èµ„æº   |
| paramIdx          | å‚æ•°ç´¢å¼• | number  | çƒ­ç‚¹å‚æ•°ç´¢å¼•ä½ç½® |
| grade             | é™æµæ¨¡å¼ | 0/1     | 0:çº¿ç¨‹æ•°, 1:QPS  |
| count             | å•æœºé˜ˆå€¼ | number  | é™æµé˜ˆå€¼         |
| durationInSec     | ç»Ÿè®¡çª—å£ | number  | ç»Ÿè®¡çª—å£æ—¶é•¿(ç§’) |
| paramFlowItemList | ä¾‹å¤–é¡¹   | array   | å‚æ•°ä¾‹å¤–é…ç½®     |
| clusterMode       | é›†ç¾¤æ¨¡å¼ | boolean | æ˜¯å¦é›†ç¾¤é™æµ     |

#### ç³»ç»Ÿè§„åˆ™ (SystemRule)

| å­—æ®µ              | æ˜¾ç¤ºå          | ç±»å‹   | è¯´æ˜             |
| ----------------- | --------------- | ------ | ---------------- |
| highestSystemLoad | æœ€é«˜ Load       | number | ç³»ç»Ÿæœ€é«˜è´Ÿè½½     |
| highestCpuUsage   | æœ€é«˜ CPU ä½¿ç”¨ç‡ | number | CPU ä½¿ç”¨ç‡ä¸Šé™   |
| avgRt             | å¹³å‡ RT         | number | æ‰€æœ‰å…¥å£å¹³å‡ RT  |
| maxThread         | æœ€å¤§çº¿ç¨‹æ•°      | number | å…¥å£æœ€å¤§å¹¶å‘æ•°   |
| qps               | å…¥å£ QPS        | number | æ‰€æœ‰å…¥å£æµé‡ QPS |

#### æˆæƒè§„åˆ™ (AuthorityRule)

| å­—æ®µ     | æ˜¾ç¤ºå   | ç±»å‹   | è¯´æ˜                   |
| -------- | -------- | ------ | ---------------------- |
| resource | èµ„æºå   | string | è§„åˆ™ä½œç”¨çš„èµ„æº         |
| limitApp | æµæ§åº”ç”¨ | string | è°ƒç”¨æ–¹åº”ç”¨å(é€—å·åˆ†éš”) |
| strategy | æˆæƒç±»å‹ | 0/1    | 0:ç™½åå•, 1:é»‘åå•     |

---

## 4. é€šç”¨ç»„ä»¶è®¾è®¡

### 4.1 è¡¨æ ¼ç»„ä»¶å¢å¼º

```typescript
// é€šç”¨è¡¨æ ¼ Props
interface DataTableProps<T> {
  data: T[];
  columns: Column<T>[];
  loading?: boolean;
  // åˆ†é¡µ
  pagination?: {
    current: number;
    pageSize: number;
    total: number;
    onChange: (page: number, size: number) => void;
  };
  // æœç´¢
  searchable?: boolean;
  searchPlaceholder?: string;
  onSearch?: (keyword: string) => void;
  // æ ‘å½¢å±•ç¤º
  treeMode?: boolean;
  childrenKey?: string;
  // è¡Œæ“ä½œ
  rowActions?: (row: T) => React.ReactNode;
}
```

### 4.2 è§„åˆ™è¡¨å•å¯¹è¯æ¡†

```typescript
// é€šç”¨è§„åˆ™å¯¹è¯æ¡† Props
interface RuleDialogProps<T> {
  open: boolean;
  onClose: () => void;
  mode: "create" | "edit";
  initialData?: T;
  onSubmit: (data: T) => Promise<void>;
  title: string;
}
```

### 4.3 æœºå™¨é€‰æ‹©å™¨

```typescript
// æœºå™¨é€‰æ‹©å™¨ Props
interface MachineSelectorProps {
  app: string;
  value?: string; // "ip:port"
  onChange: (value: string) => void;
}
```

---

## 5. API è®¾è®¡

### 5.1 æ–°å¢ API å°è£…

```typescript
// lib/api/resource.ts - ç°‡ç‚¹é“¾è·¯ API
export const resourceApi = {
  // è·å–æœºå™¨èµ„æºé“¾è·¯
  getMachineResource: (ip: string, port: number, type?: string, searchKey?: string) =>
    apiClient.get<ClusterNode[]>("/resource/machineResource.json", {
      params: { ip, port, type, searchKey },
    }),
};

// lib/api/metric.ts - ç›‘æ§æ•°æ® API (å¢å¼º)
export const metricApi = {
  // è·å–å®æ—¶ç›‘æ§æ•°æ®
  queryMetric: (app: string, resource: string, startTime: number, endTime: number) =>
    apiClient.get<MetricData[]>("/metric/queryByAppAndResource.json", {
      params: { app, identity: resource, startTime, endTime },
    }),

  // è·å– Top èµ„æº
  queryTopResource: (app: string, pageIndex: number, pageSize: number, desc: boolean) =>
    apiClient.get("/metric/queryTopResourceMetric.json", {
      params: { app, pageIndex, pageSize, desc },
    }),
};
```

### 5.2 Hooks è®¾è®¡

```typescript
// hooks/api/use-resource.ts
export function useResources(app: string, machine: { ip: string; port: number }) {
  return useQuery({
    queryKey: ["resources", app, machine.ip, machine.port],
    queryFn: () => resourceApi.getMachineResource(machine.ip, machine.port),
    enabled: !!app && !!machine.ip,
    refetchInterval: 10000, // 10ç§’åˆ·æ–°ä¸€æ¬¡
  });
}

// hooks/api/use-metric.ts (å¢å¼º)
export function useMetricHistory(app: string, resource: string, timeRange: [number, number]) {
  return useQuery({
    queryKey: ["metric-history", app, resource, timeRange],
    queryFn: () => metricApi.queryMetric(app, resource, timeRange[0], timeRange[1]),
    enabled: !!app && !!resource,
  });
}
```

---

## 6. å®ç°ä¼˜å…ˆçº§

### Phase 1 - æ ¸å¿ƒåŠŸèƒ½å®Œå–„

1. âœ… TypeScript é”™è¯¯ä¿®å¤
2. âŒ ç°‡ç‚¹é“¾è·¯é¡µé¢ï¼ˆæ–°å¢ï¼‰
3. ğŸ”„ ç³»ç»Ÿè§„åˆ™ç¼–è¾‘åŠŸèƒ½

### Phase 2 - ç”¨æˆ·ä½“éªŒæå‡

4. ğŸ”„ åˆ—è¡¨é¡µåˆ†é¡µåŠŸèƒ½
5. ğŸ”„ åˆ—è¡¨é¡µæœç´¢è¿‡æ»¤
6. ğŸ”„ å®æ—¶ç›‘æ§å›¾è¡¨

### Phase 3 - é«˜çº§åŠŸèƒ½

7. âŒ é›†ç¾¤æµæ§å®Œå–„
8. âŒ æ‰¹é‡æ“ä½œ
9. âŒ æ•°æ®å¯¼å…¥å¯¼å‡º

---

## 7. ç»„ä»¶ç›®å½•ç»“æ„ï¼ˆæœ€ç»ˆï¼‰

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ui/                    # åŸºç¡€ UI ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DataTable.tsx      # é€šç”¨æ•°æ®è¡¨æ ¼
â”‚   â”‚   â”œâ”€â”€ Pagination.tsx     # åˆ†é¡µç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SearchInput.tsx    # æœç´¢è¾“å…¥æ¡†
â”‚   â”‚   â””â”€â”€ ConfirmDialog.tsx  # ç¡®è®¤å¯¹è¯æ¡†
â”‚   â”‚
â”‚   â””â”€â”€ dashboard/
â”‚       â”œâ”€â”€ layout/            # å¸ƒå±€ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ Layout.tsx
â”‚       â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚       â”‚   â””â”€â”€ AppMenu.tsx
â”‚       â”‚
â”‚       â”œâ”€â”€ identity/          # ç°‡ç‚¹é“¾è·¯ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ ResourceTable.tsx
â”‚       â”‚   â”œâ”€â”€ ResourceTreeTable.tsx
â”‚       â”‚   â”œâ”€â”€ MachineSelector.tsx
â”‚       â”‚   â””â”€â”€ QuickRuleButtons.tsx
â”‚       â”‚
â”‚       â”œâ”€â”€ metric/            # ç›‘æ§ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ MetricChart.tsx
â”‚       â”‚   â””â”€â”€ MetricTable.tsx
â”‚       â”‚
â”‚       â””â”€â”€ rules/             # è§„åˆ™ç›¸å…³ç»„ä»¶
â”‚           â”œâ”€â”€ RuleListLayout.tsx
â”‚           â”œâ”€â”€ FlowRuleForm.tsx
â”‚           â”œâ”€â”€ DegradeRuleForm.tsx
â”‚           â”œâ”€â”€ ParamFlowRuleForm.tsx
â”‚           â”œâ”€â”€ SystemRuleForm.tsx
â”‚           â””â”€â”€ AuthorityRuleForm.tsx
â”‚
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ dashboard/
â”‚       â”œâ”€â”€ overview.tsx       # é¦–é¡µ
â”‚       â”œâ”€â”€ identity/          # ç°‡ç‚¹é“¾è·¯
â”‚       â”‚   â””â”€â”€ index.tsx
â”‚       â”œâ”€â”€ metric/            # å®æ—¶ç›‘æ§
â”‚       â”‚   â””â”€â”€ index.tsx
â”‚       â”œâ”€â”€ flow/              # æµæ§è§„åˆ™
â”‚       â”‚   â”œâ”€â”€ list.tsx
â”‚       â”‚   â”œâ”€â”€ create.tsx
â”‚       â”‚   â””â”€â”€ edit.tsx
â”‚       â”œâ”€â”€ degrade/           # é™çº§è§„åˆ™
â”‚       â”œâ”€â”€ param-flow/        # çƒ­ç‚¹è§„åˆ™
â”‚       â”œâ”€â”€ system/            # ç³»ç»Ÿè§„åˆ™
â”‚       â”œâ”€â”€ authority/         # æˆæƒè§„åˆ™
â”‚       â”œâ”€â”€ cluster/           # é›†ç¾¤æµæ§
â”‚       â””â”€â”€ machines/          # æœºå™¨åˆ—è¡¨
â”‚
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ use-app.ts
â”‚       â”œâ”€â”€ use-machine.ts
â”‚       â”œâ”€â”€ use-resource.ts    # æ–°å¢
â”‚       â”œâ”€â”€ use-metric.ts      # å¢å¼º
â”‚       â”œâ”€â”€ use-flow-rule.ts
â”‚       â”œâ”€â”€ use-degrade-rule.ts
â”‚       â”œâ”€â”€ use-param-flow-rule.ts
â”‚       â”œâ”€â”€ use-system-rule.ts
â”‚       â”œâ”€â”€ use-authority-rule.ts
â”‚       â””â”€â”€ use-cluster.ts
â”‚
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ api/
â”‚       â”œâ”€â”€ client.ts
â”‚       â”œâ”€â”€ app.ts
â”‚       â”œâ”€â”€ machine.ts
â”‚       â”œâ”€â”€ resource.ts        # æ–°å¢
â”‚       â”œâ”€â”€ metric.ts          # å¢å¼º
â”‚       â”œâ”€â”€ flow-rule.ts
â”‚       â”œâ”€â”€ degrade-rule.ts
â”‚       â”œâ”€â”€ param-flow-rule.ts
â”‚       â”œâ”€â”€ system-rule.ts
â”‚       â”œâ”€â”€ authority-rule.ts
â”‚       â””â”€â”€ cluster.ts
â”‚
â””â”€â”€ types/
    â”œâ”€â”€ sentinel.ts            # å¢å¼º ClusterNode ç±»å‹
    â”œâ”€â”€ rule.ts
    â””â”€â”€ cluster.ts
```

---

## 8. ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç¡®è®¤è®¾è®¡** - è¯·ç¡®è®¤ä»¥ä¸Šè®¾è®¡æ˜¯å¦ç¬¦åˆé¢„æœŸ
2. **å¼€å§‹å®ç°** - æŒ‰ä¼˜å…ˆçº§é¡ºåºå®ç°åŠŸèƒ½
3. **æµ‹è¯•éªŒè¯** - æ¯å®Œæˆä¸€ä¸ªåŠŸèƒ½æ¨¡å—è¿›è¡Œæµ‹è¯•
